(function(){var e,t;t=angular.module("tumblrGame.rounds"),e=function(){function e(e,t,o,r,n,s,a,i,l,u){e.round=s.get("current_round"),console.log("PARM: "+l.win),r.jsonp_query({tag:"reaction-gif",before:l.before},function(t){var o;return o=a("filter")(t.response,{type:"photo"}),e.gif=o[0].photos[0].original_size.url}),e.winMessage="true"===l.win?"Correct! You win!":'Out of time! The answer was "'+l.tag+'"',e.posts=[],r.jsonp_query({tag:l.tag,before:l.before},function(t){var o,r,n,s,a;for(s=t.response,a=[],r=0,n=s.length;n>r;r++)if(o=s[r],"photo"===o.type){if(e.posts.push(o),e.posts.length>=6)break;a.push(void 0)}else a.push(void 0);return a}),e.storyline=n.get_story(e.round-1,"end"),t.open({template:o.get("storyline/story.tpl.html"),controller:"StoryCtrl",className:"story "+e.storyline.dialogs[0].type,plain:!0,scope:e,showClose:!1}),e.play=function(){return i.transitionTo("select")},u.bindTo(e).add({combo:"enter",description:"Next Stage",callback:e.play})}return e.$inject=["$scope","ngDialog","$templateCache","RoundsRes","StoryService","gameStorage","$filter","$state","$stateParams","hotkeys"],e}(),t.controller("EndCtrl",e)}).call(this);