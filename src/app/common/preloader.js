(function(){var t,e,i=function(t,e){return function(){return t.apply(e,arguments)}};e=angular.module("common.preloader",[]),t=function(t,e){var o;return o=function(){function o(e){this.loadImageLocation=i(this.loadImageLocation,this),this.handleImageLoad=i(this.handleImageLoad,this),this.handleImageError=i(this.handleImageError,this),this.imageLocations=e,this.imageCount=this.imageLocations.length,this.loadCount=0,this.errorCount=0,this.states={PENDING:1,LOADING:2,RESOLVED:3,REJECTED:4},this.state=this.states.PENDING,this.deferred=t.defer(),this.promise=this.deferred.promise}return o.preloadImages=function(t){var e;return e=new o(t),e.load()},o.prototype.isInitiated=function(){return this.state!==this.states.PENDING},o.prototype.isRejected=function(){return this.state===this.states.REJECTED},o.prototype.isResolved=function(){return this.state===this.states.RESOLVED},o.prototype.load=function(){var t,e,i;if(this.isInitiated())return this.promise;for(this.state=this.states.LOADING,t=e=0,i=this.imageCount-1;i>=e;t=e+=1)this.loadImageLocation(this.imageLocations[t]);return this.promise},o.prototype.handleImageError=function(t){return this.errorCount++,this.isRejected()?void 0:(this.state=this.states.REJECTED,this.deferred.reject(t))},o.prototype.handleImageLoad=function(t){return this.loadCount++,this.isRejected()?void 0:(this.deferred.notify({percent:Math.ceil(this.loadCount/this.imageCount*100),imageLocation:t}),this.loadCount===this.imageCount?(this.state=this.states.RESOLVED,this.deferred.resolve(this.imageLocations)):void 0)},o.prototype.loadImageLocation=function(t){var i,o,r,s;return o=this,i=null,s=function(t){return e.$apply(function(){return o.handleImageLoad(t.target.src),o=i=t=null})},r=function(t){return e.$apply(function(){return o.handleImageError(t.target.src),o=i=t=null})},i=new Image,i.onload=s,i.onerror=r,i.src=t},o}()},e.factory("imagePreloader",["$q","$rootScope",t])}).call(this);